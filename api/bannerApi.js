import{BASE_URL,myFunction}from"./baseApi.js";const loader=document.getElementById("loader"),tabs=document.getElementById("myTabContent");export const getAllBanners=async()=>{try{const e=await fetch(`${BASE_URL}/banners`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return await e.json()}catch(e){return console.error("Error fetching banners:",e),null}};export const createBanner=async e=>{try{const n=await fetch(`${BASE_URL}/banners`,{method:"POST",body:e,credentials:"include"});if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);return await n.json()}catch(e){return console.error("Error creating banner:",e),null}};export const updateBanner=async(e,n)=>{try{const t=await fetch(`${BASE_URL}/banners/${e}`,{method:"PUT",body:n,credentials:"include"});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);return await t.json()}catch(e){return console.error("Error updating banner:",e),null}};let newImages=[],imagesToRemove=[];export const populateBanners=e=>{const n=document.getElementById("bannerMediaPreview");console.log(e),n.innerHTML="";const t=[...e.data[0].media||[]];console.log(n),t.forEach(((e,t)=>{const o=document.createElement("div");o.classList.add("media-item","me-3","mb-3"),o.innerHTML=`\n      <img\n        src="${e}"\n        alt="Media Preview"\n        class="img-thumbnail"\n        style="width: 100px; height: 100px; object-fit: cover;"\n      />\n      <button\n        type="button"\n        class="btn btn-danger btn-sm mt-2 removeExistingMedia"\n        data-url="${e}"\n      >\n        - Remove\n      </button>\n    `,n.appendChild(o);o.querySelector(".removeExistingMedia").addEventListener("click",(()=>{imagesToRemove.push(e),o.remove()}))}))};document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("bannerMedia"),n=document.getElementById("bannerMediaPreview");e.addEventListener("change",(e=>{Array.from(e.target.files).forEach((e=>{const t=new FileReader;t.onload=t=>{const o=document.createElement("div");o.classList.add("media-item","me-3","mb-3"),o.innerHTML=`\n          <img\n            src="${t.target.result}"\n            alt="New Media Preview"\n            class="img-thumbnail"\n            style="width: 100px; height: 100px; object-fit: cover;"\n          />\n          <button\n            type="button"\n            class="btn btn-danger btn-sm mt-2 removeNewMedia"\n          >\n            - Remove\n          </button>\n        `,n.appendChild(o),newImages.push(e),console.log(newImages);o.querySelector(".removeNewMedia").addEventListener("click",(()=>{newImages=newImages.filter((n=>n!==e)),o.remove()}))},t.readAsDataURL(e)}))})),document.getElementById("uploadForm").addEventListener("submit",(async e=>{e.preventDefault(),console.log("uploaded");const n=new FormData;newImages&&newImages.length>0&&newImages.forEach((e=>{n.append("photos",e)})),imagesToRemove.length>0&&(console.log(imagesToRemove),n.append("imagesToRemove",JSON.stringify(imagesToRemove)));try{await updateBanner("676669795875626f8f2dd82f",n),myFunction("Banner Submitted Successfully")}catch(e){console.error("Error handling form submission:",e)}}))}));